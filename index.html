<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discover - Unfiltered Liquidity Pools</title>
    <style>
        body{font-family:Arial,sans-serif;background:#111;color:#eee;margin:0;padding:20px;}
        .header{display:flex;flex-wrap:wrap;gap:15px;align-items:center;margin-bottom:20px;}
        h1{margin:0;font-size:24px;}
        .search-bar{padding:10px;width:300px;background:#333;border:none;border-radius:4px;color:white;}
        .filters select{padding:8px;background:#333;color:white;border:1px solid #555;border-radius:4px;}
        table{width:100%;border-collapse:collapse;background:#222;font-size:14px;overflow-x:auto;display:block;white-space:nowrap;}
        th,td{padding:10px 12px;border-bottom:1px solid #444;text-align:right;}
        th{background:#333;cursor:pointer;user-select:none;}
        th:first-child,td:first-child{text-align:left;}
        .pair-cell{display:flex;align-items:center;gap:12px;flex-wrap:wrap;}
        .dex-info{display:flex;gap:6px;align-items:center;font-size:12px;color:#aaa;}
        .dex-logo{width:18px;height:18px;border-radius:4px;}
        .pair-link{color:#00ff88;text-decoration:none;font-weight:bold;}
        .pair-link:hover{text-decoration:underline;}
        .mini-chart{width:110px;height:36px;background:#222;border:1px solid #444;border-radius:2px;overflow:hidden;}
        .simulate{background:#0066ff;color:white;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:12px;}
        .positive{color:#00ff88;}
        .footer-controls{margin-top:20px;text-align:right;}
        .footer-controls select{padding:8px;background:#333;color:white;border:1px solid #555;border-radius:4px;}
    </style>
</head>
<body>
    <div class="header">
        <h1>Discover - Unfiltered Liquidity Pools</h1>
        <input type="text" class="search-bar" placeholder="Search pair..." id="searchInput">
        <div class="filters">
            <select id="dexFilter"></select>
            <select id="chainFilter"></select>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Pair</th>
                <th>Age</th>
                <th>TVL</th>
                <th>Fees (24h)</th>
                <th>Fee/TVL</th>
                <th class="positive">APR (Adj. IL)</th>
                <th>Volatility</th>
                <th>Correlation</th>
                <th>Rewards/TVL</th>
                <th>Volume/TVL</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="poolsBody"></tbody>
    </table>

    <div class="footer-controls">
        Show <select id="pageSize">
            <option value="10" selected>10</option>
            <option value="20">20</option>
            <option value="50">50</option>
            <option value="100">100</option>
        </select> rows
    </div>

<script>
// DEXs + real logos + correct pool links
const dexData = [
    {name:"Uniswap",      chain:"Ethereum",   version:"v3", logo:"https://cryptologos.cc/logos/uniswap-uni-logo.svg?v=024",   url:"https://app.uniswap.org/explore/pools/ethereum/"},
    {name:"PancakeSwap",  chain:"BNB Chain",  version:"v3", logo:"https://cryptologos.cc/logos/pancakeswap-cake-logo.svg?v=024", url:"https://pancakeswap.finance/info/pool/"},
    {name:"Raydium",      chain:"Solana",     version:"CLMM", logo:"https://cryptologos.cc/logos/raydium-ray-logo.svg?v=024",   url:"https://raydium.io/liquidity/"},
    {name:"Orca",         chain:"Solana",     version:"Whirl", logo:"https://cryptologos.cc/logos/orca-orca-logo.svg?v=024",     url:"https://www.orca.so/pool/"},
    {name:"SushiSwap",    chain:"Ethereum",   version:"v3", logo:"https://cryptologos.cc/logos/sushiswap-sushi-logo.svg?v=024",url:"https://www.sushi.com/pool/"},
    {name:"Aerodrome",    chain:"Base",       version:"Slipstream", logo:"https://cryptologos.cc/logos/aerodrome-finance-aero-logo.svg?v=024", url:"https://aerodrome.finance/pools/"},
    {name:"Velodrome",    chain:"Optimism",   version:"v2", logo:"https://cryptologos.cc/logos/velodrome-finance-velo-logo.svg?v=024", url:"https://app.velodrome.finance/liquidity/"},
    {name:"QuickSwap",    chain:"Polygon",    version:"v3", logo:"https://cryptologos.cc/logos/quickswap-quick-logo.svg?v=024", url:"https://quickswap.exchange/#/pools/"},
    {name:"Meteora",      chain:"Solana",     version:"DLMM", logo:"https://meteora.ag/logo.png", url:"https://app.meteora.ag/pools/"},
    {name:"Pump.fun",     chain:"Solana",     version:"Launchpad", logo:"https://pump.fun/logo.png", url:"https://pump.fun/"}
];

const tokens = ["USDC","USDT","SOL","ETH","WIF","BONK","JUP","MATIC","BNB","PEPE","SHIB","DOGE","WETH","CAKE","RAY"];
let masterPools = [];

// Generate realistic mock pools (fast!)
dexData.forEach(dex => {
    for(let i=0;i<18;i++){
        const base = tokens[Math.floor(Math.random()*tokens.length)];
        const quote = tokens[Math.floor(Math.random()*tokens.length)];
        if(base===quote) continue;
        const tvl = Math.round(Math.random()*18e6 + 2e5);
        const fees24h = Math.round(Math.random()*12e4 + 800);
        const feeTvl = Number((fees24h/tvl*100).toFixed(3));
        const trend = Math.random()<0.28?-1:(Math.random()<0.55?1:0);
        const priceData = Array.from({length:30},(_,j)=>100+Math.random()*280+j*trend*2.8+Math.random()*18-9);
        const drawdown = (Math.max(...priceData)-Math.min(...priceData))/Math.max(...priceData);
        const adjApr = Number((feeTvl*(1-drawdown)).toFixed(2));
        const age = dex.name==="Pump.fun" ? `${Math.floor(Math.random()*23)+1}h` : `${Math.floor(Math.random()*320)+20}d`;
        const fakeAddr = "0x"+Math.random().toString(16).substr(2,40).slice(0,12)+"...";

        masterPools.push({
            pair: `${base}/${quote}`,
            dex: dex.name,
            chain: dex.chain,
            version: dex.version,
            logo: dex.logo,
            poolUrl: dex.url + fakeAddr,
            age, tvl, fees24h, feeTvl, adjApr,
            volatility:(Math.random()*0.65+0.12).toFixed(2),
            correlation:(Math.random()*0.75+0.15).toFixed(2),
            rewardsTvl:(Math.random()*28).toFixed(2),
            volTvl:(Math.random()*280+30).toFixed(2),
            priceData, trend
        });
    }
});

let filtered = [...masterPools];
let display = [];

// Fill dropdowns
const dexSelect = document.getElementById("dexFilter");
["All DEXs", ...dexData.map(d=>d.name)].forEach(d=>dexSelect.add(new Option(d,d)));
dexSelect.value = "All DEXs";

const chainSelect = document.getElementById("chainFilter");
["All Chains", ...new Set(dexData.map(d=>d.chain))].sort().forEach(c=>chainSelect.add(new Option(c,c)));

dexSelect.onchange = () => { if(dexSelect.value!=="All DEXs") chainSelect.value=dexData.find(d=>d.name===dexSelect.value).chain; apply(); };
chainSelect.onchange = apply;
document.getElementById("searchInput").oninput = apply;
document.getElementById("pageSize").onchange = updateDisplay;

// SVG mini-chart
function drawChart(el,data,trend){
    const color = trend===-1?"#ff4444":trend===1?"#00ff88":"#ffaa00";
    const min=Math.min(...data), max=Math.max(...data);
    if(max===min){el.innerHTML="";return;}
    const pts = data.map((v,i)=>`${i*110/29},${36-(v-min)/(max-min)*34}`).join(" ");
    el.innerHTML = `<svg width="110" height="36"><polyline fill="none" stroke="${color}" stroke-width="2" points="${pts}"/></svg>`;
}

function render(){
    const tbody = document.getElementById("poolsBody");
    tbody.innerHTML = "";
    display.forEach(p=>{
        const row = document.createElement("tr");
        row.innerHTML = `
            <td class="pair-cell">
                <div class="dex-info">
                    <img src="${p.logo}" class="dex-logo" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22><circle cx=12 cy=12 r=10 fill=%22%23404040%22/></svg>'">
                    <span>${p.version} â€¢ ${p.chain}</span>
                </div>
                <a href="${p.poolUrl}" target="_blank" class="pair-link" rel="noopener">${p.pair}</a>
                <div class="mini-chart"></div>
            </td>
            <td>${p.age}</td>
            <td>$${p.tvl.toLocaleString()}</td>
            <td>$${p.fees24h.toLocaleString()}</td>
            <td>${p.feeTvl.toFixed(2)}%</td>
            <td class="positive">${p.adjApr}%</td>
            <td>${p.volatility}</td>
            <td>${p.correlation}</td>
            <td>${p.rewardsTvl}%</td>
            <td>${p.volTvl}%</td>
            <td><button class="simulate">Simulate</button></td>`;
        tbody.appendChild(row);
        drawChart(row.querySelector(".mini-chart"), p.priceData, p.trend);
    });
}

function apply(){
    const search = document.getElementById("searchInput").value.toLowerCase();
    const dex = dexSelect.value;
    const chain = chainSelect.value;

    filtered = masterPools.filter(p=>
        p.pair.toLowerCase().includes(search) &&
        (dex==="All DEXs" || p.dex===dex) &&
        (chain==="All Chains" || p.chain===chain)
    );

    filtered.sort((a,b)=>b.feeTvl - a.feeTvl);
    filtered.sort((a,b)=> Math.abs(a.feeTvl-b.feeTvl)<0.01 ? b.adjApr-a.adjApr : b.feeTvl-a.feeTvl);

    updateDisplay();
}

function updateDisplay(){
    const size = +document.getElementById("pageSize").value;
    display = filtered.slice(0,size);
    render();
}

// Start instantly
setTimeout(()=>{ apply(); }, 50);
</script>
</body>
</html>
